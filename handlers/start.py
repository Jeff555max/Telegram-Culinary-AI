from aiogram import Router
from aiogram.filters import Command, CommandStart
from aiogram.types import (
    InlineKeyboardButton,
    InlineKeyboardMarkup,
    KeyboardButton,
    Message,
    ReplyKeyboardMarkup,
    WebAppInfo,
)

from config import get_settings

router = Router(name="start")


@router.message(CommandStart())
async def cmd_start(message: Message) -> None:
    settings = get_settings()
    webapp_url = settings.webapp_url
    reply_markup = None

    if webapp_url:
        reply_markup = ReplyKeyboardMarkup(
            keyboard=[
                [
                    KeyboardButton(
                        text="üöÄ Mini App",
                        web_app=WebAppInfo(url=webapp_url),
                    )
                ]
            ],
            resize_keyboard=True,
        )

    await message.answer(
        (
            "üë©‚Äçüç≥ –ü—Ä–∏–≤–µ—Ç! –Ø AI Cooking Assistant.\n\n"
            "–Ø —É–º–µ—é:\n"
            "‚Ä¢ –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ 3 –ø–æ–¥—Ä–æ–±–Ω—ã—Ö —Ä–µ—Ü–µ–ø—Ç–∞;\n"
            "‚Ä¢ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –∏ –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å, —á—Ç–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å;\n"
            "‚Ä¢ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≥–æ—Ç–æ–≤–æ–µ –±–ª—é–¥–æ –Ω–∞ —Ñ–æ—Ç–æ –∏ –¥–∞–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç —Å –≤–∞—Ä–∏–∞—Ü–∏—è–º–∏;\n"
            "‚Ä¢ –≤–µ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ (/chef), –∑–∞–¥–∞–≤–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –≤—ã–¥–∞–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç;\n"
            "‚Ä¢ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ–Ω—Ä–∞–≤–∏–≤—à–µ–µ—Å—è –±–ª—é–¥–æ –ø–æ –Ω–∞–∂–∞—Ç–∏—é –Ω–∞ ‚≠ê –ø–æ–¥ –∫–∞–∂–¥—ã–º —Ä–µ—Ü–µ–ø—Ç–æ–º.\n\n"
            "–ü—Ä–∏–º–µ—Ä—ã:\n"
            "‚Ä¢ ¬´–∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞, –±—Ä–æ–∫–∫–æ–ª–∏, —Å–ª–∏–≤–∫–∏, –ø–∞—Ä–º–µ–∑–∞–Ω¬ª;\n"
            "‚Ä¢ —Ñ–æ—Ç–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞;\n"
            "‚Ä¢ —Ñ–æ—Ç–æ –≥–æ—Ç–æ–≤–æ–≥–æ –±–ª—é–¥–∞ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ.\n\n"
            "–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏–ª–∏ –ø—Ä–∏—à–ª–∏ —Ñ–æ—Ç–æ. "
            "–ü–æ—Å–ª–µ —Ñ–æ—Ç–æ –≤—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö –Ω–∏–∂–µ —Å–æ–æ–±—â–µ–Ω–∏—è."
        ),
        reply_markup=reply_markup,
    )


@router.message(Command("help"))
async def cmd_help(message: Message) -> None:
    await message.answer(
        (
            "‚ÑπÔ∏è –ë—ã—Å—Ç—Ä—ã–π –≥–∞–π–¥:\n"
            "1. –¢–µ–∫—Å—Ç ‚Äî –ø—Ä–∏—à–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –∏ —è –≤–µ—Ä–Ω—É 3 —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ—Ü–µ–ø—Ç–∞.\n"
            "2. –§–æ—Ç–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ ‚Äî –æ—Ç–ø—Ä–∞–≤—å —Å–Ω–∏–º–æ–∫, –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏ ¬´–≠—Ç–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã¬ª.\n"
            "3. –§–æ—Ç–æ –≥–æ—Ç–æ–≤–æ–≥–æ –±–ª—é–¥–∞ ‚Äî –æ—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ –∏ –Ω–∞–∂–º–∏ ¬´–ì–æ—Ç–æ–≤–æ–µ –±–ª—é–¥–æ¬ª.\n"
            "4. /chef ‚Äî –∑–∞–ø—É—Å—Ç–∏ —Ä–µ–∂–∏–º —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤: —è —Å–æ–±–µ—Ä—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –≤—ã–¥–∞–º —Ä–µ—Ü–µ–ø—Ç.\n"
            "5. –ñ–º–∏ –Ω–∞ ‚≠ê –ø–æ–¥ –±–ª—é–¥–æ–º, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ–≥–æ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É SQLite.\n\n"
            "–°–æ–≤–µ—Ç—ã: –¥–æ–±–∞–≤–ª—è–π —É—Ç–æ—á–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´—Ö–æ—á—É –±–µ–∑ –≥–ª—é—Ç–µ–Ω–∞¬ª), "
            "–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–µ –∑–∞–±—É–¥—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å .env —Å —Ç–æ–∫–µ–Ω–∞–º–∏."
        )
    )


@router.message(Command("miniapp"))
async def cmd_miniapp(message: Message) -> None:
    settings = get_settings()
    if not settings.webapp_url:
        await message.answer(
            "WEBAPP_URL –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –£–∫–∞–∂–∏ –ø—É–±–ª–∏—á–Ω—ã–π –∞–¥—Ä–µ—Å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ .env –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞."
        )
        return

    markup = InlineKeyboardMarkup(
        inline_keyboard=[
            [
                InlineKeyboardButton(
                    text="–û—Ç–∫—Ä—ã—Ç—å Mini App",
                    web_app=WebAppInfo(url=settings.webapp_url),
                )
            ]
        ]
    )
    await message.answer(
        "Mini App –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Telegram. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É —Å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏.",
        reply_markup=markup,
    )

